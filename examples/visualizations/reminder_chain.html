
<!DOCTYPE html>
<html>
<head>
    <title>Chain Visualization</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.26.0/cytoscape.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dagre/0.8.5/dagre.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/cytoscape-dagre@2.5.0/cytoscape-dagre.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        #cy {
            width: 100%;
            height: 800px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .controls {
            margin-bottom: 20px;
        }
        button {
            padding: 8px 16px;
            margin-right: 8px;
            border: none;
            border-radius: 4px;
            background-color: #2196F3;
            color: white;
            cursor: pointer;
            font-size: 14px;
        }
        button:hover {
            background-color: #1976D2;
        }
    </style>
</head>
<body>
    <div class="controls">
        <button onclick="cy.fit()">Fit to View</button>
        <button onclick="cy.center()">Center</button>
        <button onclick="cy.layout(layout).run()">Reset Layout</button>
    </div>
    <div id="cy"></div>
    <script>
        // Initialize Cytoscape
        const config = {"elements": {"nodes": [{"data": {"id": "81a1d2dd-940e-40b3-96bb-b809a246a645", "label": "Sequential Chain", "type": "sequential_chain", "artifacts": []}}, {"data": {"id": "d5437e38-ab91-4185-86aa-dc911725d026", "label": "analyze_input", "type": "step", "has_input_transform": false, "has_output_transform": false, "retry_strategy": {"max_retries": 3, "delay": 1}}}, {"data": {"id": "3b375499-fdff-44a1-948e-bfefc0d96478", "label": "process_data", "type": "step", "has_input_transform": false, "has_output_transform": false, "retry_strategy": {"max_retries": 3, "delay": 1}}}, {"data": {"id": "7ffecf1f-b3fe-483b-a501-244809d50f9b", "label": "generate_summary", "type": "step", "has_input_transform": false, "has_output_transform": false, "retry_strategy": {"max_retries": 3, "delay": 1}}}, {"data": {"id": "5d44789d-76dc-4dfb-9e28-77fb48981ae6", "label": "Parallel Chain", "type": "parallel_chain", "artifacts": [], "max_concurrent": 2}}, {"data": {"id": "c2d1f509-8d55-467e-8b35-5e1449a37627", "label": "analyze_sentiment", "type": "step", "has_input_transform": false, "has_output_transform": false, "retry_strategy": {"max_retries": 3, "delay": 1}}}, {"data": {"id": "cec43c4c-bc0d-4040-9d71-24c27a7582f4", "label": "extract_keywords", "type": "step", "has_input_transform": false, "has_output_transform": false, "retry_strategy": {"max_retries": 3, "delay": 1}}}, {"data": {"id": "173ee4c3-5adc-4600-b2ad-cc6b12c529e9", "label": "identify_topics", "type": "step", "has_input_transform": false, "has_output_transform": false, "retry_strategy": {"max_retries": 3, "delay": 1}}}, {"data": {"id": "a10b9639-3351-4cdc-9c4d-4c91783ae840", "label": "Chord Chain", "type": "chord_chain", "artifacts": []}}, {"data": {"id": "4f6adcc9-f477-4872-ba81-5ff985330de5", "label": "Parallel Chain", "type": "parallel_chain", "artifacts": [], "max_concurrent": 2}}, {"data": {"id": "7f67d830-4b7e-47cc-89fe-e00347f2ecab", "label": "research_topic_1", "type": "step", "has_input_transform": false, "has_output_transform": false, "retry_strategy": {"max_retries": 3, "delay": 1}}}, {"data": {"id": "c8316276-0bed-473d-9074-6e37c720628c", "label": "research_topic_2", "type": "step", "has_input_transform": false, "has_output_transform": false, "retry_strategy": {"max_retries": 3, "delay": 1}}}, {"data": {"id": "ff54aef4-48d8-40dd-962b-be2fb1a130e4", "label": "research_topic_3", "type": "step", "has_input_transform": false, "has_output_transform": false, "retry_strategy": {"max_retries": 3, "delay": 1}}}, {"data": {"id": "46b89563-8468-45a0-aad4-580b90a1e9f4", "label": "synthesize_research", "type": "step", "has_input_transform": false, "has_output_transform": false, "retry_strategy": {"max_retries": 3, "delay": 1}}}, {"data": {"id": "c2692787-dcde-4fbc-9392-ff030c879fe6", "label": "Group Chain", "type": "group_chain", "artifacts": []}}, {"data": {"id": "454134a8-bfd8-4988-9c6e-eac2a73f449e", "label": "Sequential Chain", "type": "sequential_chain", "artifacts": []}}, {"data": {"id": "61be9c22-9dbe-41e1-8745-350853d64007", "label": "task_1a", "type": "step", "has_input_transform": false, "has_output_transform": false, "retry_strategy": {"max_retries": 3, "delay": 1}}}, {"data": {"id": "32bd4411-dc9f-4c41-bb3f-a5adc5bbcdbe", "label": "task_1b", "type": "step", "has_input_transform": false, "has_output_transform": false, "retry_strategy": {"max_retries": 3, "delay": 1}}}, {"data": {"id": "e3949234-52fc-48d6-b02e-899783b47774", "label": "Sequential Chain", "type": "sequential_chain", "artifacts": []}}, {"data": {"id": "fb4fefb0-892a-42ac-b584-e6d48e8d1e6f", "label": "task_2a", "type": "step", "has_input_transform": false, "has_output_transform": false, "retry_strategy": {"max_retries": 3, "delay": 1}}}, {"data": {"id": "c8b5d178-ce42-4adc-931d-5aa2033c2a98", "label": "task_2b", "type": "step", "has_input_transform": false, "has_output_transform": false, "retry_strategy": {"max_retries": 3, "delay": 1}}}, {"data": {"id": "9be9ce4f-5737-40e7-a349-c925cbfa1c0d", "label": "Map Chain", "type": "map_chain", "artifacts": []}}, {"data": {"id": "900a2861-9ddc-4965-876d-8ee8ae1c9ad5", "label": "Sequential Chain", "type": "sequential_chain", "artifacts": []}}, {"data": {"id": "34fc576f-d0ac-4a56-a4f9-6c226040e368", "label": "process_item", "type": "step", "has_input_transform": false, "has_output_transform": false, "retry_strategy": {"max_retries": 3, "delay": 1}}}, {"data": {"id": "e1e6a646-e9b3-4e55-97a5-5a3fae3f0058", "label": "validate_result", "type": "step", "has_input_transform": false, "has_output_transform": false, "retry_strategy": {"max_retries": 3, "delay": 1}}}, {"data": {"id": "cc3d88fd-ab6a-4035-8cd9-49d7ab2dc990", "label": "Reminder Chain", "type": "reminder_chain", "artifacts": [], "prune_completed": true, "max_context_items": 2}}, {"data": {"id": "1a424e6d-2e7f-49fe-8c5b-d0cc9e66565e", "label": "initial_analysis", "type": "step", "has_input_transform": false, "has_output_transform": false, "retry_strategy": {"max_retries": 3, "delay": 1}}}, {"data": {"id": "bc6b2e65-5b46-4689-adf9-6c0dd38a972e", "label": "follow_up_questions", "type": "step", "has_input_transform": false, "has_output_transform": false, "retry_strategy": {"max_retries": 3, "delay": 1}}}, {"data": {"id": "e3c2dbe0-0ecd-4f82-bb67-1f596b6ce6d2", "label": "final_synthesis", "type": "step", "has_input_transform": false, "has_output_transform": false, "retry_strategy": {"max_retries": 3, "delay": 1}}}], "edges": [{"data": {"id": "e1", "source": "81a1d2dd-940e-40b3-96bb-b809a246a645", "target": "d5437e38-ab91-4185-86aa-dc911725d026", "label": "contains"}}, {"data": {"id": "e2", "source": "81a1d2dd-940e-40b3-96bb-b809a246a645", "target": "3b375499-fdff-44a1-948e-bfefc0d96478", "label": "contains"}}, {"data": {"id": "e3", "source": "d5437e38-ab91-4185-86aa-dc911725d026", "target": "3b375499-fdff-44a1-948e-bfefc0d96478", "label": "next", "chain_id": "81a1d2dd-940e-40b3-96bb-b809a246a645"}}, {"data": {"id": "e4", "source": "81a1d2dd-940e-40b3-96bb-b809a246a645", "target": "7ffecf1f-b3fe-483b-a501-244809d50f9b", "label": "contains"}}, {"data": {"id": "e5", "source": "3b375499-fdff-44a1-948e-bfefc0d96478", "target": "7ffecf1f-b3fe-483b-a501-244809d50f9b", "label": "next", "chain_id": "81a1d2dd-940e-40b3-96bb-b809a246a645"}}, {"data": {"id": "e6", "source": "d5437e38-ab91-4185-86aa-dc911725d026", "target": "3b375499-fdff-44a1-948e-bfefc0d96478", "label": "next", "chain_id": "81a1d2dd-940e-40b3-96bb-b809a246a645"}}, {"data": {"id": "e7", "source": "3b375499-fdff-44a1-948e-bfefc0d96478", "target": "7ffecf1f-b3fe-483b-a501-244809d50f9b", "label": "next", "chain_id": "81a1d2dd-940e-40b3-96bb-b809a246a645"}}, {"data": {"id": "e8", "source": "5d44789d-76dc-4dfb-9e28-77fb48981ae6", "target": "c2d1f509-8d55-467e-8b35-5e1449a37627", "label": "contains"}}, {"data": {"id": "e9", "source": "5d44789d-76dc-4dfb-9e28-77fb48981ae6", "target": "cec43c4c-bc0d-4040-9d71-24c27a7582f4", "label": "contains"}}, {"data": {"id": "e10", "source": "5d44789d-76dc-4dfb-9e28-77fb48981ae6", "target": "173ee4c3-5adc-4600-b2ad-cc6b12c529e9", "label": "contains"}}, {"data": {"id": "e11", "source": "a10b9639-3351-4cdc-9c4d-4c91783ae840", "target": "4f6adcc9-f477-4872-ba81-5ff985330de5", "label": "contains"}}, {"data": {"id": "e12", "source": "4f6adcc9-f477-4872-ba81-5ff985330de5", "target": "7f67d830-4b7e-47cc-89fe-e00347f2ecab", "label": "contains"}}, {"data": {"id": "e13", "source": "4f6adcc9-f477-4872-ba81-5ff985330de5", "target": "c8316276-0bed-473d-9074-6e37c720628c", "label": "contains"}}, {"data": {"id": "e14", "source": "4f6adcc9-f477-4872-ba81-5ff985330de5", "target": "ff54aef4-48d8-40dd-962b-be2fb1a130e4", "label": "contains"}}, {"data": {"id": "e15", "source": "a10b9639-3351-4cdc-9c4d-4c91783ae840", "target": "46b89563-8468-45a0-aad4-580b90a1e9f4", "label": "contains"}}, {"data": {"id": "e16", "source": "7f67d830-4b7e-47cc-89fe-e00347f2ecab", "target": "46b89563-8468-45a0-aad4-580b90a1e9f4", "label": "callback", "chain_id": "a10b9639-3351-4cdc-9c4d-4c91783ae840"}}, {"data": {"id": "e17", "source": "c8316276-0bed-473d-9074-6e37c720628c", "target": "46b89563-8468-45a0-aad4-580b90a1e9f4", "label": "callback", "chain_id": "a10b9639-3351-4cdc-9c4d-4c91783ae840"}}, {"data": {"id": "e18", "source": "ff54aef4-48d8-40dd-962b-be2fb1a130e4", "target": "46b89563-8468-45a0-aad4-580b90a1e9f4", "label": "callback", "chain_id": "a10b9639-3351-4cdc-9c4d-4c91783ae840"}}, {"data": {"id": "e19", "source": "a10b9639-3351-4cdc-9c4d-4c91783ae840", "target": "4f6adcc9-f477-4872-ba81-5ff985330de5", "label": "contains"}}, {"data": {"id": "e20", "source": "7f67d830-4b7e-47cc-89fe-e00347f2ecab", "target": "46b89563-8468-45a0-aad4-580b90a1e9f4", "label": "callback", "chain_id": "a10b9639-3351-4cdc-9c4d-4c91783ae840"}}, {"data": {"id": "e21", "source": "c8316276-0bed-473d-9074-6e37c720628c", "target": "46b89563-8468-45a0-aad4-580b90a1e9f4", "label": "callback", "chain_id": "a10b9639-3351-4cdc-9c4d-4c91783ae840"}}, {"data": {"id": "e22", "source": "ff54aef4-48d8-40dd-962b-be2fb1a130e4", "target": "46b89563-8468-45a0-aad4-580b90a1e9f4", "label": "callback", "chain_id": "a10b9639-3351-4cdc-9c4d-4c91783ae840"}}, {"data": {"id": "e23", "source": "c2692787-dcde-4fbc-9392-ff030c879fe6", "target": "454134a8-bfd8-4988-9c6e-eac2a73f449e", "label": "contains"}}, {"data": {"id": "e24", "source": "454134a8-bfd8-4988-9c6e-eac2a73f449e", "target": "61be9c22-9dbe-41e1-8745-350853d64007", "label": "contains"}}, {"data": {"id": "e25", "source": "454134a8-bfd8-4988-9c6e-eac2a73f449e", "target": "32bd4411-dc9f-4c41-bb3f-a5adc5bbcdbe", "label": "contains"}}, {"data": {"id": "e26", "source": "61be9c22-9dbe-41e1-8745-350853d64007", "target": "32bd4411-dc9f-4c41-bb3f-a5adc5bbcdbe", "label": "next", "chain_id": "454134a8-bfd8-4988-9c6e-eac2a73f449e"}}, {"data": {"id": "e27", "source": "c2692787-dcde-4fbc-9392-ff030c879fe6", "target": "e3949234-52fc-48d6-b02e-899783b47774", "label": "contains"}}, {"data": {"id": "e28", "source": "e3949234-52fc-48d6-b02e-899783b47774", "target": "fb4fefb0-892a-42ac-b584-e6d48e8d1e6f", "label": "contains"}}, {"data": {"id": "e29", "source": "e3949234-52fc-48d6-b02e-899783b47774", "target": "c8b5d178-ce42-4adc-931d-5aa2033c2a98", "label": "contains"}}, {"data": {"id": "e30", "source": "fb4fefb0-892a-42ac-b584-e6d48e8d1e6f", "target": "c8b5d178-ce42-4adc-931d-5aa2033c2a98", "label": "next", "chain_id": "e3949234-52fc-48d6-b02e-899783b47774"}}, {"data": {"id": "e31", "source": "c2692787-dcde-4fbc-9392-ff030c879fe6", "target": "454134a8-bfd8-4988-9c6e-eac2a73f449e", "label": "contains"}}, {"data": {"id": "e32", "source": "61be9c22-9dbe-41e1-8745-350853d64007", "target": "32bd4411-dc9f-4c41-bb3f-a5adc5bbcdbe", "label": "next", "chain_id": "454134a8-bfd8-4988-9c6e-eac2a73f449e"}}, {"data": {"id": "e33", "source": "c2692787-dcde-4fbc-9392-ff030c879fe6", "target": "e3949234-52fc-48d6-b02e-899783b47774", "label": "contains"}}, {"data": {"id": "e34", "source": "fb4fefb0-892a-42ac-b584-e6d48e8d1e6f", "target": "c8b5d178-ce42-4adc-931d-5aa2033c2a98", "label": "next", "chain_id": "e3949234-52fc-48d6-b02e-899783b47774"}}, {"data": {"id": "e35", "source": "9be9ce4f-5737-40e7-a349-c925cbfa1c0d", "target": "900a2861-9ddc-4965-876d-8ee8ae1c9ad5", "label": "contains"}}, {"data": {"id": "e36", "source": "900a2861-9ddc-4965-876d-8ee8ae1c9ad5", "target": "34fc576f-d0ac-4a56-a4f9-6c226040e368", "label": "contains"}}, {"data": {"id": "e37", "source": "900a2861-9ddc-4965-876d-8ee8ae1c9ad5", "target": "e1e6a646-e9b3-4e55-97a5-5a3fae3f0058", "label": "contains"}}, {"data": {"id": "e38", "source": "34fc576f-d0ac-4a56-a4f9-6c226040e368", "target": "e1e6a646-e9b3-4e55-97a5-5a3fae3f0058", "label": "next", "chain_id": "900a2861-9ddc-4965-876d-8ee8ae1c9ad5"}}, {"data": {"id": "e39", "source": "9be9ce4f-5737-40e7-a349-c925cbfa1c0d", "target": "900a2861-9ddc-4965-876d-8ee8ae1c9ad5", "label": "contains"}}, {"data": {"id": "e40", "source": "34fc576f-d0ac-4a56-a4f9-6c226040e368", "target": "e1e6a646-e9b3-4e55-97a5-5a3fae3f0058", "label": "next", "chain_id": "900a2861-9ddc-4965-876d-8ee8ae1c9ad5"}}, {"data": {"id": "e41", "source": "cc3d88fd-ab6a-4035-8cd9-49d7ab2dc990", "target": "1a424e6d-2e7f-49fe-8c5b-d0cc9e66565e", "label": "contains"}}, {"data": {"id": "e42", "source": "cc3d88fd-ab6a-4035-8cd9-49d7ab2dc990", "target": "bc6b2e65-5b46-4689-adf9-6c0dd38a972e", "label": "contains"}}, {"data": {"id": "e43", "source": "1a424e6d-2e7f-49fe-8c5b-d0cc9e66565e", "target": "bc6b2e65-5b46-4689-adf9-6c0dd38a972e", "label": "next_with_context", "chain_id": "cc3d88fd-ab6a-4035-8cd9-49d7ab2dc990"}}, {"data": {"id": "e44", "source": "cc3d88fd-ab6a-4035-8cd9-49d7ab2dc990", "target": "e3c2dbe0-0ecd-4f82-bb67-1f596b6ce6d2", "label": "contains"}}, {"data": {"id": "e45", "source": "bc6b2e65-5b46-4689-adf9-6c0dd38a972e", "target": "e3c2dbe0-0ecd-4f82-bb67-1f596b6ce6d2", "label": "next_with_context", "chain_id": "cc3d88fd-ab6a-4035-8cd9-49d7ab2dc990"}}]}, "style": [{"selector": "node", "style": {"label": "data(label)", "text-valign": "center", "text-halign": "center", "text-wrap": "wrap", "text-max-width": "100px", "font-size": "12px", "width": "120px", "height": "40px", "border-width": "1px", "padding": "10px", "shape": "roundrectangle"}}, {"selector": "node[type = 'sequential_chain']", "style": {"background-color": "#E8F5E9", "border-color": "#66BB6A", "border-width": "2px"}}, {"selector": "node[type = 'parallel_chain']", "style": {"background-color": "#E3F2FD", "border-color": "#42A5F5", "border-width": "2px"}}, {"selector": "node[type = 'chord_chain']", "style": {"background-color": "#F3E5F5", "border-color": "#AB47BC", "border-width": "2px"}}, {"selector": "node[type = 'group_chain']", "style": {"background-color": "#FFF3E0", "border-color": "#FB8C00", "border-width": "2px"}}, {"selector": "node[type = 'map_chain']", "style": {"background-color": "#E0F7FA", "border-color": "#26C6DA", "border-width": "2px"}}, {"selector": "node[type = 'reminder_chain']", "style": {"background-color": "#F1F8E9", "border-color": "#7CB342", "border-width": "2px"}}, {"selector": "node[type = 'recursive_chain']", "style": {"background-color": "#FBE9E7", "border-color": "#FF7043", "border-width": "2px"}}, {"selector": "node[type = 'step']", "style": {"background-color": "#FFFFFF", "border-color": "#9E9E9E", "border-width": "1px", "shape": "round-rectangle", "width": "100px", "height": "35px"}}, {"selector": "edge", "style": {"width": "2px", "curve-style": "bezier", "target-arrow-shape": "triangle", "line-color": "#9E9E9E", "target-arrow-color": "#9E9E9E", "label": "data(label)", "font-size": "10px", "text-rotation": "autorotate", "text-margin-y": "-10px"}}, {"selector": "edge[label = 'contains']", "style": {"line-style": "dashed", "line-color": "#BDBDBD", "target-arrow-color": "#BDBDBD"}}, {"selector": "edge[label = 'next']", "style": {"line-color": "#2196F3", "target-arrow-color": "#2196F3"}}, {"selector": "edge[label = 'callback']", "style": {"line-color": "#9C27B0", "target-arrow-color": "#9C27B0"}}, {"selector": "edge[label = 'next_with_context']", "style": {"line-color": "#4CAF50", "target-arrow-color": "#4CAF50"}}, {"selector": "edge[label = 'may_recurse']", "style": {"line-color": "#FF5722", "target-arrow-color": "#FF5722", "line-style": "dotted"}}], "layout": {"name": "dagre", "rankDir": "TB", "nodeSep": 50, "rankSep": 100, "padding": 30, "animate": true, "animationDuration": 500}, "wheelSensitivity": 0.2, "minZoom": 0.2, "maxZoom": 3.0, "userZoomingEnabled": true, "userPanningEnabled": true, "boxSelectionEnabled": true};
        const layout = config.layout;

        // Create Cytoscape instance
        const cy = cytoscape({
            ...config,
            container: document.getElementById('cy')
        });

        // Add interactive features
        cy.on('tap', 'node', function(evt) {
            const node = evt.target;
            console.log('Node tapped:', node.data());
        });

        cy.on('mouseover', 'node', function(evt) {
            const node = evt.target;
            node.style({
                'border-width': '3px',
                'border-color': '#000000'
            });
        });

        cy.on('mouseout', 'node', function(evt) {
            const node = evt.target;
            node.removeStyle();
        });

        // Initial layout
        cy.layout(layout).run();
    </script>
</body>
</html>
